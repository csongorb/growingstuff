"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),Logger=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_classCallCheck(this,e),this.prefix="DTAds:"+t,this.debug=o}return _createClass(e,[{key:"log",value:function(e,t){var o=this.prefix;this.debug&&(void 0!==e&&void 0!==t&&("string"==typeof e?(e=o+":"+e,console.log(e,t)):console.log(o,e,t)),void 0!==e&&void 0===t&&("string"==typeof e?(e=o+":"+e,console.log(e)):console.log(o,e)))}},{key:"warn",value:function(e,t){var o=this.prefix;this.debug&&(void 0!==e&&void 0!==t&&("string"==typeof e?(e=o+":"+e,console.warn(e,t)):console.warn(o,e,t)),void 0!==e&&void 0===t&&("string"==typeof e?(e=o+":"+e,console.warn(e)):console.warn(o,e)))}},{key:"error",value:function(e,t){var o=this.prefix;this.debug&&(void 0!==e&&void 0!==t&&("string"==typeof e?(e=o+":"+e,console.error(e,t)):console.error(o,e,t)),void 0!==e&&void 0===t&&("string"==typeof e?(e=o+":"+e,console.error(e)):console.error(o,e)))}}]),e}(),_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),_Bigtop=function(){function e(t){var o=(t.enabled,t.barkeep),i=t.allowed_experiences,n=t.prefix,r=t.debug,s=void 0!==r&&r,a=t.max_height,l=void 0===a?500:a,d=t.max_width,g=void 0===d?1920:d,u=t.min_width,c=void 0===u?null:u;if(_classCallCheck(this,e),this.logger=new Logger("Ads:Bigtop",s),this.logger.log(s),this.prefix=n,this.pint_cont_class=n+"-bigtop-container",this.barkeep=o,this.allowed_experiences=i,this.max_width=g,this.max_height=l,this.min_width=c,this.ratio=g/l,void 0===this.barkeep)return void this.logger.error("Barkeep not referenced");this.setup()||this.logger.error("Bigtop container unable to be inserted")}return _createClass(e,[{key:"setup",value:function(){var e=this.prefix,t=this.allowed_experiences,o=this.pint_cont_class,i=t.map(function(t){return e+"-"+t});i=i.join(" ");var n='<div class="m-pint h-pint '+o+'" data-type="static" data-priority="1">\n\t\t\t\t\t\t\t\t<div class="'+e+"-slot "+e+"-slot-bigtop "+i+'" data-slot-type="bigtop"></div>\n\t\t\t\t\t\t\t</div>';return!!this.barkeep.insert(n)&&(this.slot_insert_listener(),!0)}},{key:"slot_insert_listener",value:function(){var e=this;window.addEventListener("slot_elements_defined",function(t){var o=document.querySelector("."+e.pint_cont_class);if(o){var i=o.querySelector("."+e.prefix+"-slot");t.detail.slots=[].slice.call(t.detail.slots);var n=!0,r=!1,s=void 0;try{for(var a,l=t.detail.slots[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var d=a.value;if(d.el_id===i.id){e.slot=d;break}}}catch(e){r=!0,s=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw s}}e.slot&&e.slot_render_listener()}})}},{key:"slot_render_listener",value:function(){var e=this;this.logger.log("slot_render_listener"),window.googletag.cmd.push(function(){window.googletag.pubads().addEventListener("slotRenderEnded",function(t){if(t.slot===e.slot.gpt_slot&&!t.isEmpty){var o=e.slot.el.querySelector("iframe");o.width="100%",e.resize_manager(o,!0),e.barkeep.setup();var i=!1;window.addEventListener("resize",function(t){i||(e.resize_manager(o,!1),setTimeout(function(){i=!1,clearTimeout()},200),i=!0)})}})})}},{key:"resize_manager",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.max_height,i=this.max_width,n=this.ratio,r=this.min_width,s=window.innerWidth,a=r||document.body.clientWidth,l=void 0;l=s/n,!t&&s<a||(e.height=l<o&&s<i?l+"px":o+"px")}}]),e}(),_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),Amazon=function(){function e(t){var o=t.enable,i=void 0===o||o,n=t.enable_refresh,r=void 0===n||n,s=t.js_url,a=void 0===s?"":s,l=t.account_id,d=void 0===l?0:l,g=t.timeout,u=void 0===g?600:g,c=t.refresh_timeout,f=void 0===c?500:c,h=t.debug,p=void 0!==h&&h;if(_classCallCheck(this,e),!i)return void this.logger.warn("Module not enabled");this.logger=new Logger("Pre:Amazon",p),this.logger.log("Init"),this.args={enable_refresh:r,js_url:a,account_id:d,timeout:u,refresh_timeout:f},this.first_time=!0}return _createClass(e,[{key:"process",value:function(){var e=this;return this.logger.log("Getting bids..."),new Promise(function(t,o){var i=e.args,n=i.account_id,r=i.timeout,s=(i.enable,i.js_url),a=void 0;setTimeout(function(){t("timeout")},r),a=function(){try{amznads.getAdsCallback(n,function(){window.amznads.setTargetingForGPTAsync("amznslots"),t(window.amznads.getTokens())},r)}catch(e){o(e)}},e.first_time?function(){var e=void 0,t=void 0;e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src=s,e.onload=function(){a()},t=document.getElementsByTagName("head")[0],t.insertBefore(e,t.firstChild)}():window.amznads?(window.googletag.pubads().clearTargeting("amznslots"),a()):t("missing window.amznads")})}},{key:"refresh",value:function(){var e=this;return this.logger.log("Refreshing bids..."),new Promise(function(t,o){var i=e.args,n=i.account_id,r=i.enable_refresh,s=i.refresh_timeout;if(!r)return void t("disabled");if(!window.amznads)return void t("missing window.amznads");setTimeout(function(){t("timeout")},s),window.googletag.pubads().clearTargeting("amznslots");try{amznads.getAdsCallback(n,function(){window.amznads.setTargetingForGPTAsync("amznslots"),t(window.amznads.getTokens())},s)}catch(e){o(e)}})}}]),e}(),_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),Openx=function(){function e(t){var o=t.enable,i=void 0===o||o,n=t.enable_refresh,r=void 0===n||n,s=t.js_url,a=void 0===s?"":s,l=t.timeout,d=void 0===l?600:l,g=t.refresh_timeout,u=void 0===g?500:g,c=t.debug,f=void 0===c?500:c;if(_classCallCheck(this,e),!i)return void this.logger.warn("Module not enabled");this.logger=new Logger("Pre:Openx",f),this.logger.log("Init"),this.args={enable_refresh:r,js_url:a,timeout:d,refresh_timeout:u},this.first_time=!0}return _createClass(e,[{key:"process",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.logger.log("Getting bids..."),new Promise(function(i,n){var r=e.args,s=r.timeout,a=(r.enable,r.js_url),l=void 0,d=void 0,g=void 0,u=void 0,c=void 0,f=void 0,h=void 0;for(l=[],g=0,u=t.length;g<u;g++)if(t[g].sizes&&t[g].sizes.length&&t[g].el_id){for(d=[],c=0,f=t[g].sizes.length;c<f;c++)d.push(t[g].sizes[c][0]+"x"+t[g].sizes[c][1]);l.push([o,JSON.parse(JSON.stringify(d)),t[g].el_id])}if(!l.length)return void i("empty");setTimeout(function(){i("timeout")},s),h=function(){var e=void 0,o=void 0,n=void 0,r=void 0,s=void 0;for(window.OX||i("OX not ready"),e=0,o=t.length;e<o;e++)if(t[e].sizes&&t[e].sizes.length&&t[e].el_id)try{n=window.OX.dfp_bidder.getSize(t[e].el_id),r=window.OX.dfp_bidder.getPrice(t[e].el_id),n&&r&&"t"!==r&&(t[e].keyvals.oxb=n+"_"+r)}catch(e){continue}s=window.OX.dfp_bidder.getPriceMap(),i(s)},e.first_time?(e.first_time=!1,window.OX_dfp_ads=l,window.oxDone=h,function(){var e=void 0,t=void 0;e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src=a,t=document.getElementsByTagName("head")[0],t.insertBefore(e,t.firstChild)}()):window.OX.dfp_bidder.addSlots(l,h)})}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.logger.log("Refreshing bids..."),new Promise(function(o,i){var n=e.args,r=n.refresh_timeout,s=n.enable_refresh,a=void 0,l=void 0,d=void 0;if(!s)return void o("disabled");for(a=[],l=0,d=t.length;l<d;l++)t[l].gpt_slot&&a.push(t[l].gpt_slot);return a.length?window.OX?(setTimeout(function(){o("timeout")},r),void window.OX.dfp_bidder.refresh(function(){var e=void 0,t=void 0,i=void 0,n=void 0;for(e=window.OX.dfp_bidder.getPriceMap()||{},t=0,i=a.length;t<i;t++)(n=a[t].getSlotId().getDomId())&&n in e&&a[t].setTargeting("oxb",e[n].size+"_"+e[n].price);o(e)},a)):void o("missing window.OX"):void o("empty")})}}]),e}(),_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),Prebid=function(){function e(t){var o=t.enable,i=void 0===o||o,n=t.enable_refresh,r=void 0===n||n,s=t.bids,a=void 0===s?[]:s,l=t.timeout,d=void 0===l?600:l,g=t.refresh_timeout,u=void 0===g?500:g,c=t.debug,f=void 0===c?500:c;if(_classCallCheck(this,e),!i)return void this.logger.warn("Module not enabled");this.logger=new Logger("Pre:Prebid",f),this.logger.log("Init"),this.args={enable_refresh:r,bids:a,timeout:d,refresh_timeout:u},window.pbjs=void 0!==window.pbjs?window.pbjs:{},window.pbjs.que=window.pbjs.que||[]}return _createClass(e,[{key:"process",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments[1];return this.logger.log("Getting and process bids..."),new Promise(function(i,n){var r=e.args.timeout,s=e.args.bids,a=[];s.length||i("No Bidders");var l=!0,d=!1,g=void 0;try{for(var u,c=t[Symbol.iterator]();!(l=(u=c.next()).done);l=!0){var f=u.value;if(f.sizes&&f.sizes.length&&f.el_id){e.logger.log("Starting bid on slot (id: "+f.el_id+") of type ("+f.type+"))");var h=[],p=!0,v=!1,_=void 0;try{for(var m,b=s[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var y=m.value,w=void 0,x=void 0,C=void 0;switch(w=y.bid_map||{},y.bidder){case"aol":for(k=f.sizes.length;k--;)x=f.sizes[k][0]+"x"+f.sizes[k][1],w[x]&&(C=JSON.parse(JSON.stringify(y)),C.params.placement=w[x][0],C.params.sizeId=w[x][1],h.push(JSON.parse(JSON.stringify(C))));break;case"yieldbot":for(k=f.sizes.length;k--;)x=f.sizes[k][0]+"x"+f.sizes[k][1],w[x]&&(C=JSON.parse(JSON.stringify(y)),C.params.psn=w[x][0],C.params.slot=w[x][1],h.push(JSON.parse(JSON.stringify(C))));break;case"pulsepoint":for(k=f.sizes.length;k--;)x=f.sizes[k][0]+"x"+f.sizes[k][1],w[x]&&(C=JSON.parse(JSON.stringify(y)),C.params.cf=x,C.params.ct=w[x],h.push(JSON.parse(JSON.stringify(C))));break;case"sovrn":for(k=f.sizes.length;k--;)x=f.sizes[k][0]+"x"+f.sizes[k][1],w[x]&&(C=JSON.parse(JSON.stringify(y)),C.params.tagid=w[x],h.push(JSON.parse(JSON.stringify(C))));break;case"sonobi":C=JSON.parse(JSON.stringify(y)),C.params.ad_unit=o,C.params.dom_id=f.el_id,h.push(JSON.parse(JSON.stringify(C)));break;default:h.push(y)}}}catch(e){v=!0,_=e}finally{try{!p&&b.return&&b.return()}finally{if(v)throw _}}a.push({code:f.el_id,sizes:JSON.parse(JSON.stringify(f.sizes)),bids:JSON.parse(JSON.stringify(h))})}}}catch(e){d=!0,g=e}finally{try{!l&&c.return&&c.return()}finally{if(d)throw g}}if(e.logger.log("ad_units",a),!a.length)return void i("empty");window.pbjs.que.push(function(){setTimeout(function(){i("timeout")},r+400),window.pbjs.addAdUnits(a),window.pbjs.requestBids({timeout:r,adUnits:a,bidsBackHandler:function(e){var o=void 0,n=void 0;o=window.pbjs.getAdserverTargeting(),o=o||{};for(var r=0;r<t.length;r++){if(!(!t[r].el_id||!o[t[r].el_id])){n=o[t[r].el_id],n=n||{};for(var s in n)n.hasOwnProperty(s)&&n[s]&&(t[r].keyvals[s]=n[s])}}i(e)}})})})}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.logger.log("Refreshing bids..."),new Promise(function(o,i){var n=e.args,r=n.bids,s=n.enable_refresh,a=n.refresh_timeout,l=void 0;if(!s)return void o("disabled");if(!r.length)return void o("no bidders");l=[];for(var d=0;d<t.length;d++)t[d].sizes&&t[d].sizes.length&&t[d].el_id&&l.push(t[d].el_id);if(!l.length)return void o("empty");window.pbjs.que.push(function(){setTimeout(function(){o("timeout")},a),window.pbjs.requestBids({adUnitCodes:l,bidsBackHandler:function(e){window.pbjs.setTargetingForGPTAsync(l),o(e)}})})})}}]),e}(),_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),Pre=function(){function e(t){var o=t.enable,i=void 0!==o&&o,n=t.prebid,r=void 0===n?{}:n,s=t.openx,a=void 0===s?{}:s,l=t.amazon,d=void 0===l?{}:l,g=t.timeout,u=void 0===g?600:g,c=t.refresh_timeout,f=void 0===c?500:c,h=t.enable_refresh,p=void 0===h||h,v=t.onBidTimeout,_=void 0===v?null:v,m=t.debug,b=void 0!==m&&m;if(_classCallCheck(this,e),this.logger=new Logger("Pre",b),this.is_enabled=i,!i)return void this.logger.warn("Module not enabled");this.logger.log("Init"),this.args={enable_refresh:p,timeout:u,refresh_timeout:f,prebid:r,openx:a,amazon:d,onBidTimeout:_},this.setupDeps(),r&&r.enable?(r.timeout=u,r.enable_refresh=p,r.refresh_timeout=f,r.debug=b,this.prebid=new Prebid(r)):this.logger.log("Prebid disabled"),a&&a.enable?(a.timeout=u,a.enable_refresh=p,a.refresh_timeout=f,a.debug=b,this.openx=new Openx(a)):this.logger.log("Openx disabled"),d&&d.enable?(d.timeout=u,d.enable_refresh=p,d.refresh_timeout=f,d.debug=b,this.amazon=new Amazon(d)):this.logger.log("Amazon disabled"),(d.enable||a.enable||r.enable)&&i||(this.args.enable_refresh=!1)}return _createClass(e,[{key:"setupDeps",value:function(){var e=document.createElement("script");document.head.appendChild(e),e.src="//burnside.dtcn.com/prebid/dt-prebid.js"}},{key:"process",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments[1];return new Promise(function(i,n){var r=e.args.onBidTimeout||null,s=window.performance?performance.now():0,a={prebid:!e.prebid,openx:!e.openx,amazon:!e.amazon},l=function(){for(var e in a)if(a.hasOwnProperty(e)&&!a[e])return;i("Completed")},d=function(t,o){var i=window.performance?performance.now():0,n=i-s;e.logger.warn("Pre: "+t+": took "+n+"ms to get bids back",o),"timeout"===o&&"function"==typeof r&&r(t,o)};e.prebid&&e.prebid.process(t,o).then(function(e){a.prebid=!0,d("prebid",e),l()},function(t){a.prebid=!0,e.logger.error("Prebid barfed",t),l()}).catch(function(t){e.logger.error(t)}),e.openx&&e.openx.process(t,o).then(function(e){a.openx=!0,d("openx",e),l()},function(t){a.openx=!0,e.logger.error("openx barfed",t),l()}).catch(function(t){e.logger.error(t)}),e.amazon&&e.amazon.process().then(function(e){a.amazon=!0,d("amazon",e),l()},function(t){a.amazon=!0,e.logger.error("amazon barfed",t),l()}).catch(function(t){e.logger.error(t)})})}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.logger.log("Refreshing slots..."),new Promise(function(o,i){var n=e.args,r=n.onBidTimeout,s=n.enable_refresh,a=window.performance?performance.now():0;s||o("Disabled");var l={prebid:!e.prebid,openx:!e.openx,amazon:!e.amazon},d=function(){for(k in l)if(l.hasOwnProperty(k)&&!l[k])return;o("Completed")},g=function(t,o){var i=window.performance?performance.now():0,n=i-a;e.logger.warn("Pre: "+t+": took "+n+"ms to get bids back",o),"timeout"===o&&"function"==typeof r&&r(t,o)};e.prebid&&e.prebid.refresh(t).then(function(e){l.prebid=!0,g("prebid",e),d()},function(t){l.prebid=!0,e.logger.error("Prebid refresh barfed",t),d()}).catch(function(t){e.logger.error(t)}),e.openx&&e.openx.refresh(t).then(function(e){l.openx=!0,g("openx",e),d()},function(t){l.openx=!0,e.logger.error("openx refresh barfed",t),d()}).catch(function(t){e.logger.error(t)}),e.amazon&&e.amazon.refresh(t).then(function(e){l.amazon=!0,g("amazon",e),d()},function(t){l.amazon=!0,e.logger.error("amazon refresh barfed",t),d()}).catch(function(t){e.logger.error(t)})})}}]),e}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),Ads=function(){function e(t){var o=this,i=t.prefix,n=t.self,r=void 0===n?null:n,s=t.lazy,a=void 0!==s&&s,l=t.lazy_mod,d=void 0===l?140:l,g=t.refresh_in_view,u=void 0!==g&&g,c=t.keyvals,f=void 0===c?{}:c,h=t.unit_name,p=void 0===h?"":h,v=t.demo_unit_name,_=t.onAdsReady,m=t.slotsRendered,b=t.slot_args,y=void 0===b?{}:b,w=t.supports,k=void 0===w?{}:w,x=t.krux_id,C=void 0===x?null:x,S=t.demo_key,z=void 0===S?"dtdemo":S,O=t.demo_val,j=t.debug,P=t.experience,E=t.bigtop,A=t.handleGPT;if(_classCallCheck(this,e),this.logger=new Logger("Ads",j),this.logger.log("Init"),this.args={prefix:i,experience:P,unit_name:p,slot_args:y,keyvals:f,supports:k,oop_class:y&&y.out_of_page&&y.out_of_page.class?y.out_of_page.class:i+"-out-of-page",lazy:a,lazy_mod:d,refresh_in_view:u,onAdsReady:_,slotsRendered:m,handleGPT:A,demo_key:z,demo_val:O,demo_unit_name:v},this.self=r,this.logger.log("Lazy loading: "+a),this.slots=[],this.lazy_slot_ids=[],this.krux_id=C,this.unit_name=p,this.busy=!1,O&&O.length&&v&&(this.unit_name=v),this.refresh_lock=!1,this.out_of_page_rendered=!1,z&&O?this.logger.warn("demo set",z+":"+O):this.logger.log("demo not set",z+":"+O),this._body=document.body||document.getElementsByTagName("body")[0],"object"!==_typeof(window.googletag))return void this.logger.error("No googletag found");if(!this.hasOOP()&&y.hasOwnProperty("out_of_page")){var N=document.createElement("div");N.className=i+"-slot "+this.args.oop_class,N.setAttribute("data-slot-type","out_of_page"),this._body.appendChild(N)}this.setupGpt(),this.bigtop_enabled=E.enabled,"undefined"!=typeof _Barkeep&&E.enabled&&y.hasOwnProperty("out_of_page")?(E.debug=j,E.prefix=i,this.Bigtop=new _Bigtop(E)):this.logger.warn("_Barkeep not available or OOP slot not set"),this.processEl(this._body),"function"==typeof _&&_(),window.addEventListener("load",function(){window.requestAnimationFrame(o.actuallyProcessLazyQueue.bind(o))})}return _createClass(e,[{key:"hasOOP",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.args,o=t.oop_class;t.prefix,t.experience;return!!(e?e.querySelector("."+o):document.querySelector("."+o))}},{key:"is_el_in_viewport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return!1;var o=e.getBoundingClientRect();return o.bottom>0-t&&o.right>0-t&&o.left<(window.innerWidth||document.documentElement.clientWidth)+t&&o.top<(window.innerHeight||document.documentElement.clientHeight)+t}},{key:"setupGpt",value:function(){var e=this;return window.googletag.cmd.push(function(){var t=e.args,o=(t.demo_val,t.experience),i=(t.demo_unit_name,e.unit_name);e.logger.log("Unit name set ("+i+")"),window.googletag.pubads().enableSingleRequest(),window.googletag.pubads().disableInitialLoad(),window.googletag.pubads().collapseEmptyDivs(),window.googletag.pubads().setTargeting("exp",o),e.handle_deps()}),!0}},{key:"handle_deps",value:function(){var e=this,t=this.args,o=t.demo_val,i=t.slotsRendered,n=t.prefix,r=t.handleGPT;if(!o){window.Krux||((window.Krux=function(){Krux.q.push(arguments)}).q=[]);var s=function(e){var t=void 0,o="kx"+e;return window.localStorage?window.localStorage[o]||"":navigator.cookieEnabled?(t=document.cookie.match(o+"=([^;]*)"))&&unescape(t[1])||"":""};"undefined"!=typeof Krux&&this.krux_id?(Krux.user=s("user"),Krux.segments=s("segs")&&s("segs").split(",")||[],Krux.segments&&window.googletag.pubads().setTargeting("ksg",window.maybe_to_string(Krux.segments)),Krux.user&&window.googletag.pubads().setTargeting("kuid",window.maybe_to_string(Krux.user)),window.googletag.pubads().setTargeting("thost",encodeURIComponent(location.hostname))):this.logger.warn("Krux not defined"),"function"==typeof r&&r()}window.googletag.pubads().addEventListener("slotRenderEnded",function(t){if(!e.out_of_page_rendered&&(!t.size||!t.size.length||parseInt(t.size[0])<10)){e.out_of_page_rendered=!0;(document.body||document.getElementsByTagName("body")[0]).classList.add(n+"-is-rendered"),"function"==typeof i&&i()}})}},{key:"refreshEl",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!t)return!1;var o=this.args,i=o.prefix,n=o.experience,r=(this.unit_name,this.self.Ads.refresh_throttle||1e3),s=i+"-slot",a=i+"-"+n,l=[];if(this.refresh_lock)return this.logger.log("locked up"),!1;if(this.refresh_lock=!0,this.logger.log("Refreshing el..",t),t.classList.contains(s)&&t.classList.contains(a)?(this.logger.log("Refreshing individual el"),l.push(t)):(this.logger.log("Refreshing multiple els"),l=t.querySelectorAll("."+a)),!l.length)return this.logger.log("no slots found"),this.refresh_lock=!1,!1;this.logger.log("Refreshing slots: ",l),l=[].slice.call(l);var d=[],g=!0,u=!1,c=void 0;try{for(var f,h=l[Symbol.iterator]();!(g=(f=h.next()).done);g=!0){var p=f.value;if(p.getAttribute("data-slot-id")){if(p.classList.contains(i+"-out-of-page")||"out_of_page"===p.getAttribute("data-type"))continue;for(var v=p.getAttribute("data-slot-id"),_=0;_<this.slots.length;_++)if(this.slots[_].id==v){d.push(this.slots[_].slot);break}}}}catch(e){u=!0,c=e}finally{try{!g&&h.return&&h.return()}finally{if(u)throw c}}return d.length?(void 0!==this.self.Pre?this.self.Pre.refresh(d).then(function(){e.queueSlots(d,!0)},function(t){e.logger.warn("Promise rejected from Pre",t)}).catch(function(t){e.logger.error(t)}):this.queueSlots(d,!0),setTimeout(function(){e.refresh_lock=!1},r),!0):(this.logger.warn("No slots to refresh"),!1)}},{key:"processEl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!e)return!1;var t=this.args,o=t.prefix,i=t.experience,n=t.oop_class,r="."+o+"-"+i,s=document.querySelector("."+n),a=e.querySelectorAll(r),l=void 0;return a=Array.from(a),s&&!a.includes(s)&&a.push(s),a.length?(this.logger.log("Found "+a.length+" slots for ("+i+" experience)"),l=this.getSlots(a),this.addSlots(l),this.addGroup(l),!0):(this.logger.warn("Found no slots for experience: ("+i+") experience"),!1)}},{key:"getSlots",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=this.args,i=o.experience,n=o.slot_args,r=o.prefix,s=[];if(!n)return this.logger.error("No slot types found"),!1;if(!t.length)return this.logger.error("getSlots: no slots given"),!1;this.logger.log("Slots for exp: ("+i+")",t);for(var a=0;a<t.length;a++){(function(o){var i=Date.now()+"-"+Math.random().toString(36).substr(2,4),a=r+"-"+i,l=void 0,d=void 0,g=void 0,u=function(t,o){if(!t||!o||!n[t])return!1;d=n[t].sizes||[],g=n[t].keyvals||{},s.push({id:i,el_id:a,roadblock_id:"",group_id:"",type:t,sizes:d,keyvals:g,lazy:1==o.getAttribute("data-no-lazy")||e.args.lazy,el:o,gpt_slot:null}),e.logger.log("Slot of type ("+t+") collected with id: "+a,o)};if(t[o].getAttribute("data-slot-id"))return e.logger.log("Skipping slot: ",t[o].getAttribute("data-slot-id")),"continue";if(t[o].id=a,t[o].setAttribute("data-slot-id",i),t[o].getAttribute("data-slot-type"))l=t[o].getAttribute("data-slot-type"),u(l,t[o]);else{var c=[];for(var f in n)c.includes(a)||n.hasOwnProperty(f)&&t[o].classList.contains(n[f].class)&&(c.push(a),l=f,u(l,t[o]))}})(a)}if(!s.length)return this.logger.warn("No new slots!"),!1;if(this.bigtop_enabled){var l=new CustomEvent("slot_elements_defined",{detail:{slots:s}});window.dispatchEvent(l)}return s}},{key:"addSlots",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length)return this.logger.warn("addSlots: no slot length"),!1;for(var t=0,o=0;o<e.length;o++)e[o].id&&(this.slots.push({id:e[o].id,slot:e[o]}),t++);return!!t||(this.logger.warn("No slots to added to inventory"),!1)}},{key:"addGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.args,o=t.supports,i=t.experience,n=t.keyvals,r=Date.now()+"-"+Math.random().toString(36).substr(2,4);if(!e.length)return void this.logger.warn("No slots to add to group");o[i]||this.logger.log(i+" not defined for custom units"),n.supports||(this.logger.warn("No custom units supported"),n.supports={});var s=[];if(n.supports&&n.supports.length&&o[i]&&o[i].length){Array.from(o[i]).forEach(function(e){n.supports.includes(e)&&s.push(e)})}n.supports=s,this.doGroup({id:r,keyvals:n,slots:e})}},{key:"doGroup",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=this.args,i=o.demo_val,n=o.demo_key,r=t.keyvals,s=t.slots,a=this.unit_name;return r?s?(n&&i&&(r={},r[n]=i),window.googletag.cmd.push(function(){for(var t in r)r.hasOwnProperty(t)&&r[t]&&window.googletag.pubads().setTargeting(t,window.maybe_to_string(r[t]));e.logger.log("Group level targeting applied",r),e.self.Pre&&e.self.Pre.is_enabled?e.self.Pre.process(s,a).then(function(){e.logger.log("Bidding process completed!"),e.registerSlots(s)},function(t){e.logger.error(t)}).catch(function(t){e.logger.error(t)}):e.registerSlots(s)}),!0):(this.logger.error("No group slots, killing group"),!1):(this.logger.error("No group keyvals, killing group"),!1)}},{key:"registerSlots",value:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=this.unit_name,i=Date.now()+"-"+Math.random().toString(36).substr(2,4),n=[],r=0;r<t.length;r++)n[r]=function(t){var n=t.keyvals||{};"out_of_page"===t.type?(t.gpt_slot=window.googletag.defineOutOfPageSlot(o,t.el_id).addService(window.googletag.pubads()),e.logger.log("Out of page slot defined")):t.el&&t.el.getAttribute("data-slot-type")&&"bigtop"===t.el.getAttribute("data-slot-type")?t.gpt_slot=window.googletag.defineSlot(o,t.sizes,t.el_id).setCollapseEmptyDiv(!0,!0).addService(window.googletag.pubads()):t.gpt_slot=window.googletag.defineSlot(o,t.sizes,t.el_id).addService(window.googletag.pubads());for(var r in n)n.hasOwnProperty(r)&&n[r]&&t.gpt_slot.setTargeting(r,window.maybe_to_string(n[r]));e.logger.log("Slot (id: "+t.el_id+") targeting applied ("+t.type+"). Keyvals: ",n),"roadblock"===n.type&&(t.roadblock_id=i)}(t[r]);if(!t.length)return this.logger.error("No slots to register"),!1;this.logger.log("Registering slots...",t),window.googletag.enableServices();for(var s=0;s<t.length;s++)n[s]=function(e){window.googletag.display(t[e].el_id)}(s);return this.queueSlots(t),!0}},{key:"queueSlots",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=[],i=[],n=this.args.lazy,r=this.args.refresh_in_view;if(!e.length)return!1;this.logger.log("Queuing slots...");for(var s=0;s<e.length;s++)"object"===_typeof(e[s].gpt_slot)&&null!==e[s].gpt_slot?!r||this.is_el_in_viewport(e[s].el)?n&&e[s].lazy?-1===i.indexOf(e[s].id)&&i.push(e[s].id):o.push(e[s].gpt_slot):-1===i.indexOf(e[s].id)&&i.push(e[s].id):e[s].keyvals&&"out_of_page"!==e[s].keyvals.type&&this.logger.warn("slot object missing gpt_slot",e[s]);return this.logger.warn("queued "+o.length+" slots and "+i.length+" lazy slots"),this.renderSlots(o,t),this.processLazyQueue(i),{gpt_slots:o,lazy_slot_ids:i}}},{key:"processLazyQueue",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.logger.log("processLazyQueue"),!(this.busy||!t.length)&&(this.lazy_slot_ids=t,this.busy=!0,window.requestAnimationFrame(this.actuallyProcessLazyQueue.bind(this)),window.addEventListener("scroll",function(){window.requestAnimationFrame(e.actuallyProcessLazyQueue.bind(e))}),!0)}},{key:"actuallyProcessLazyQueue",value:function(){var e=this,t=this.lazy_slot_ids||[];if(!t.length)return!1;for(var o=this.args.lazy_mod,i=[],n=this.slots,r=0;r<t.length;r++){(function(r){var s={};if(n.forEach(function(e){if(e.id===t[r])return void(s=e)}),s=s.slot||{},!s.gpt_slot||!e.is_el_in_viewport(s.el,o)||i.includes(s.gpt_slot))return"continue";i.push(s.gpt_slot),t=t.filter(function(e,t){if(e!==s.id)return e})})(r)}for(var r=0;r<t.length;r++){(function(e){var o=n.find(function(o){if(o.id===t[e])return o});if(o=o.slot||{},!o.gpt_slot||!o.roadblock_id||i.includes(o.gpt_slot))return"continue";i.push(o.gpt_slot),t=t.filter(function(e,t){if(e!==o.id)return e})})(r)}return this.lazy_slot_ids=t,this.busy=!1,this.renderSlots(i,!0),!0}},{key:"renderSlots",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o="",i={};return!!e.length&&(this.logger.log("Rendering slots..."),t?i.changeCorrelator=!1:window.googletag.cmd.push(function(){window.googletag.pubads().updateCorrelator()}),o="rendering "+e.length+" slots",o+=t?" with the same correlator id":" with a fresh correlator id",this.logger.log(o),this.logger.log("gpt_slots",e),this.logger.log("gpt_args",i),window.googletag.cmd.push(function(){window.googletag.pubads().refresh(e,i)}),!0)}}]),e}(),_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),Injector=function(){function e(t){var o=t.prefix,i=t.beforeInject,n=t.nodeFilter,r=t.self,s=void 0===r?null:r,a=t.content_target,l=t.inject_target,d=t.slot_type,g=void 0===d?"mpu":d,u=t.skip_targets,c=void 0===u?[]:u,f=t.disablePotentialsOn,h=t.filterInjectable,p=t.options,v=void 0===p?{}:p,_=t.debug,m=void 0!==_&&_,b=t.experience;_classCallCheck(this,e),this.logger=new Logger("Injector",m),this.logger.log("Init"),this.args={content_target:a,inject_target:l,slot_type:g,skip_targets:c,disablePotentialsOn:f,filterInjectable:h,options:v,experience:b,prefix:o,beforeInject:i,nodeFilter:n},this.self=s,this.is_initialized=!1,this.enabled=!1;var y={start_index:3,look_back:2,look_ahead:3,skip_ahead:10,max_ads:2,min_good_length:400,min_content_length:1100};this.default_options=y,this.args.options.hasOwnProperty(b)?(this.args.options=s.extend(this.args.options[b],y),this.logger.log("Options set for ("+b+") experience",this.args.options)):(this.args.options=y,this.logger.warn("Experience ("+b+") not found in options. Using defaults.",this.args.options));var w=document.querySelector(a);w?this.setup(w):this.logger.log("Skipping injector, target: "+a+" not found")}return _createClass(e,[{key:"setup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.args,o=t.content_target,i=t.inject_target,n=(t.options,t.disablePotentialsOn),r=t.filterInjectable,s=t.experience;if(e){
this.is_initialized=!0,this.enabled=!0;var a=e.querySelectorAll(i),l=e.children;l=[].slice.call(l);var d=e.textContent.length,g=!1;if("string"==typeof n&&(g=!window.document.querySelector(n)),g)return!0;var u=0;if(l.forEach(function(e){"P"===e.tagName&&(u+=e.textContent.length)}),d<u)return this.logger.warn("Length of "+o+" < "+u),!1;if("function"==typeof r){a=r(a,s)||[],this.logger.log("_filtered_injectables",a)}if(a&&a.length){this.logger.log("Found "+a.length+" pre-tagged nodes",a),this.inject(a);var c=!0,f=!1,h=void 0;try{for(var p,v=a[Symbol.iterator]();!(c=(p=v.next()).done);c=!0){var _=p.value;_.parentNode.removeChild(_)}}catch(e){f=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(f)throw h}}return this.logger.log("Disabling auto injection sequence."),!0}return l&&l.length?(this.logger.log("Found "+l.length+" potential nodes",l),this.processNodes(l)):this.logger.warn("Found no children of given target "+l),!0}}},{key:"processNodes",value:function(e){var t=this.args,o=(t.inject_target,t.options),i=t.nodeFilter,n=o.max_ads,r=o.skip_ahead,s=o.start_index,a=[];if(e=e.slice(s,e.length),!e.length)return!1;for(var l=0;l<e.length;l++){"function"==typeof i&&(l=i(e[l],l));var d=this.goodAbove(e[l]),g=this.goodBelow(e[l]);d&&g&&a.length<n&&(a.push(e[l]),l+=r)}return this.logger.log("Found "+a.length+" potential nodes to inject",a),!!a.length&&(this.inject(a),!0)}},{key:"goodEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.args,i=o.inject_target,n=o.skip_targets;if(i=i.slice(1,i.length),e.classList.contains(i))return!1;if("left"===getComputedStyle(e).float||"right"===getComputedStyle(e).float||e.textContent.length<16)return!1;if(n.length){var r=!0,s=!1,a=void 0;try{for(var l,d=n[Symbol.iterator]();!(r=(l=d.next()).done);r=!0){var g=l.value;if(e.classList.contains(g))return!1}}catch(e){s=!0,a=e}finally{try{!r&&d.return&&d.return()}finally{if(s)throw a}}}if(t){var u=e.querySelectorAll("*"),c=["img","object","iframe"],f=!0,h=!1,p=void 0;try{for(var v,_=c[Symbol.iterator]();!(f=(v=_.next()).done);f=!0){var m=v.value;if(e.getElementsByTagName(m).length)return!1}}catch(e){h=!0,p=e}finally{try{!f&&_.return&&_.return()}finally{if(h)throw p}}if(u&&u.length){var b=!0,y=!1,w=void 0;try{for(var k,x=u[Symbol.iterator]();!(b=(k=x.next()).done);b=!0){var C=k.value;if("left"===getComputedStyle(C).float||"right"===getComputedStyle(C).float)return!1}}catch(e){y=!0,w=e}finally{try{!b&&x.return&&x.return()}finally{if(y)throw w}}}}return!0}},{key:"goodBelow",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.args,r=(n.inject_target,n.options),s=r.look_ahead,a=r.min_good_length,l=void 0;return!(!e||"P"!==e.tagName)&&(l=e.nextElementSibling,!(!this.goodEl(e,!0)||o==s)&&(i+=e.textContent.length,i>=a?!(o<s)||function e(o,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=void 0;return!o||!("P"!==o.tagName||!t.goodEl(o,!0))&&(r=o.nextElementSibling,(n+=o.textContent.length)>=a||(i==s||e(r,++i,n)))}(l,++o):this.goodBelow(l,++o,i)))}},{key:"goodAbove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=(this.args.inject_target,this.args.options.look_back),i=void 0;return!e||(i=e.previousElementSibling,o<0||!(!this.goodEl(e)||!i)&&(t==o||this.goodAbove(i,++t)))}},{key:"inject",value:function(e){var t=this.args,o=t.prefix,i=t.experience,n=t.slot_type,r=t.beforeInject,s=o+"-"+i,a=o+"-slot-"+n,l=!1;if(!e.length)return!1;"function"==typeof r&&"string"!=typeof(a=r(a,i))&&(a=o+"-slot-"+n);var d='<div class = "'+o+"-slot "+a+" "+s+'"></div>',g=!0,u=!1,c=void 0;try{for(var f,h=e[Symbol.iterator]();!(g=(f=h.next()).done);g=!0){f.value.insertAdjacentHTML("afterend",d),this.logger.log("Node injected with class ("+s+")"),l=!0}}catch(e){u=!0,c=e}finally{try{!g&&h.return&&h.return()}finally{if(u)throw c}}return l}}]),e}(),_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),AdBlock=function(){function e(t){var o=t.init,i=void 0===o?null:o,n=t.self,r=void 0===n?null:n,s=t.onCaughtBait,a=void 0===s?null:s,l=t.blocked_class,d=void 0===l?null:l,g=t.bait_class,u=void 0===g?null:g,c=t.bait_select,f=void 0===c?null:c,h=t.bait_style,p=void 0===h?null:h,v=t.demo_val,_=t.demo_key,m=t.debug,b=void 0!==m&&m,y=t.experience;_classCallCheck(this,e),this.logger=new Logger("AdBlock",b),this.logger.log("Init"),this.args={onCaughtBait:a,blocked_class:d||"plundered",bait_class:u||"ad_container afs_ads afs_ads_dt",bait_select:f||"afs_ads_dt",bait_style:p||"width: 300px; height: 250px; position: absolute; left: -11111px; top: -111px; pointer-events: none;",demo_key:_,demo_val:v},this.self=r,this.self.ads_blocked=!1,"function"==typeof i&&i(y),this.check()}return _createClass(e,[{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=document.body||document.getElementsByTagName("body")[0],o=this.args.blocked_class;return e=e||t,this.logger.log("Applying..."),!e.classList.contains(o)&&(e.classList.add(o),!0)}},{key:"revert",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=document.body||document.getElementsByTagName("body")[0],o=this.args.blocked_class;return e=e||t,this.logger.log("Reverting..."),!!e.classList.contains(o)&&(e.classList.remove(o),!0)}},{key:"get",value:function(){return this.self.ads_blocked}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return"boolean"==typeof e&&(this.self.ads_blocked=e,!0)}},{key:"check",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.args,o=t.bait_class,i=t.bait_select,n=t.bait_style,r=t.demo_val,s=t.demo_key,a=t.onCaughtBait,l=document.body||document.getElementsByTagName("body")[0],d=void 0,g=void 0,u=void 0,c=void 0;return d=document.createElement("div"),d.className=o,d.setAttribute("style",n),l.insertBefore(d,l.firstChild),g=e||document.getElementsByClassName(i),s&&"adblock"===r?this.self.ads_blocked=!0:g.length&&(u=g[0].currentStyle?g[0].currentStyle.display:getComputedStyle(g[0],null).display,c=g[0].currentStyle?g[0].currentStyle.visibility:getComputedStyle(g[0],null).visibility,"none"===u||"hidden"===c?(this.self.ads_blocked=!0,this.logger.log("Ads blocked")):this.logger.log("Ads Unblocked")),"function"==typeof a&&a(this.self.ads_blocked,this),g[0].parentNode.removeChild(g[0]),this.self.ads_blocked}}]),e}(),_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),_Burnside=function(){function e(t){var o=arguments,i=this,n=t.prefix,r=void 0===n?"dtads":n,s=t.adblock,a=void 0===s?{}:s,l=t.injector,d=void 0===l?{}:l,g=t.pre,u=void 0===g?{}:g,c=t.ads,f=void 0===c?{}:c,h=t.experiences,p=void 0===h?{}:h,v=t.debug,_=void 0!==v&&v,m=t.demo_val,b=void 0===m?null:m,y=t.demo_key,w=void 0===y?"":y,k=t.krux_id,x=void 0===k?null:k;arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_classCallCheck(this,e),this.logger=new Logger("",_),this.logger.log("Init"),w&&b&&this.logger.log("demo set",w+":"+b),this.extend=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=1;t<o.length;t++)if(o[t])for(var i in o[t])o[t].hasOwnProperty(i)&&(e[i]=o[t][i]);return e},window.maybe_to_string=function(e){return"number"!=typeof e?e:e.toString()},this.filterBidders=u.filterBidders,this.burnside_cdn="//burnside.dtcn.com",this.gpt_src="https://www.googletagservices.com/tag/js/gpt.js",f.krux_id=x,this.setup_deps(x),this._injector_experiences=d.options,this.prefix=r,this.defineExperience(p),d.prefix=r,f.prefix=r,this.demo_val=b,a.demo_key=w,a.demo_val=b,f.demo_key=w,f.demo_val=b,a.debug=_,d.debug=_,u.debug=_,f.debug=_,a.experience=this.experience,d.experience=this.experience,f.experience=this.experience,d.self=this,a.self=this,f.self=this,this.AdBlock=new AdBlock(a),this.AdBlock.get())return void this.logger.warn("Ads blocked. Halting...");if(this.Injector=new Injector(d),u.prebid&&u.prebid.enable){var C=this.burnside_cdn+"/prebid-configs/"+u.prebid.config+"/prebid-config.js",S=function(e){var t="get_prebid_data",o=window.document.createElement("script");o.type="text/javascript",o.src=e,window[t]=function(e){u.prebid.bids=i.process_prebid_data(e),u.prebid.bids.length&&(i.Pre=new Pre(u)),i.Ads=new Ads(f),window.document.head.removeChild(o),o=null,delete window[t]},window.document.head.appendChild(o)};googletag.cmd.push(function(){S(C)})}else googletag.cmd.push(function(){i.Ads=new Ads(f)})}return _createClass(e,[{key:"setup_deps",value:function(e){var t=this.gpt_src;if(e){var o="\n\t\t\t\twindow.Krux||((Krux=function(){ Krux.q.push(arguments)}).q=[]);\n\t\t\t\t(function(){\n\t\t\t\t\twindow.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]);\n\t\t\t\t\t(function(){\n\t\t\t\t\tvar k=document.createElement('script');k.type='text/javascript';k.async=true;\n\t\t\t\t\tk.src=(location.protocol==='https:'?'https:':'http:')+'//cdn.krxd.net/controltag/"+e+".js';\n\t\t\t\t\tvar s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(k,s);\n\t\t\t\t\t}());\n\t\t\t\t}());\n\t\t\t",i=window.document.createElement("script");i.type="text/javascript",i.className="kxct",i.setAttribute("data-id",e),i.setAttribute("data-timing","async"),i.setAttribute("data-version",3),i.text=o,"function"!=typeof window.Krux&&window.document.head.appendChild(i)}var n=window.document.createElement("script");n.type="text/javascript",n.src=t,window.googletag=window.googletag||{cmd:[]},(!window.googletag||window.googletag&&"function"!=typeof googletag.getVersion)&&window.document.head.appendChild(n)}},{key:"process_prebid_data",value:function(e){return e&&e.bids?("function"==typeof this.filterBidders&&(e=this.filterBidders(e,this.experience)),e.bids):[]}},{key:"enabled",value:function(){return!this.AdBlock||!this.AdBlock.get()}},{key:"get_dtdemo",value:function(){return this.demo_val}},{key:"defineExperience",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){var o=this.prefix,i=this._injector_experiences,n=t||window.innerWidth,r=document.body||document.getElementsByTagName("body"),s=[];this.experience=null;for(var a in e)if(e.hasOwnProperty(a)){if(!i[a]){"function"!=typeof e[a]&&this.logger.error("Missing injector.option for "+a);continue}(0===e[a]||e[a]<n)&&s.push(e[a])}if(s.length>0){var l=Math.max.apply(Math,s);for(var d in e)e[d]===l&&(this.experience=d)}return this.experience=this.experience||"default",r.classList.add(o+"-exp-"+this.experience),this.logger.log("Experience set to ("+this.experience+")"),"function"==typeof e.onExperienceDefined&&e.onExperienceDefined(this.experience),this.experience}}}]),e}();